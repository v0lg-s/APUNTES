Python supone que cada archivo está oculto detrás de un *objeto* de una clase adecuada.

Los archivos se pueden procesar de maneras diferentes, dependiendo de; el contenido del archivo, las intenciones con el archivo, etc.  

Cuando usamos la función `open()` para abrir un archivo, Python devuelve un objeto *"file-like"* (objeto que se comporta como archivo) ese objeto pertenece a una clase concreta y depende de como se haya abierto el archivo.

# Clases para los objetos de archivo

Los objetos provienen de una de las clases a continuación:

![[clases_manejo_archivos_python.png]]

# Apertura de streams
La apertura de un stream se realiza mediante la función `open()`:

```python
stream = open(file, mode = 'r', encoding = None)
```

El cierre de un stream se da con la invocación del método `close()`:

```python
stream.close()
```

Para abrir y cerrar un stream es recomendable hacerlo dentro de una sentencia try: except:

```python
try:
    stream = open("C:\Users\User\Desktopile.txt", "rt")
    # El procesamiento va aquí.
    stream.close()
except Exception as exc:
    print("No se puede abrir el archivo:", exc)
```
## Modos de apertura

**Letra principal:**
- `r` = *read* $\rightarrow$ abre para leer (el archivo debe existir)
- `w` = *write* $\rightarrow$ abre para escribir (crea o trunca: Borra el contenido previo)
- `a` = *append* $\rightarrow$ abre para agregar al final (crea si no existe)
- `x` = *exclusive create* $\rightarrow$ crea archivo nuevo; falla si existe.

**Modificadores:**
- `b` = *binary* $\rightarrow$ trabajar con bytes.
- `t` = *text* $\rightarrow$ trabajar con texto. **Nota:** Es el default, si no se pone nada, es el de texto.
- `+` = *update* $\rightarrow$ lectura y escritura.
### Modos de texto
Al abrir un archivo con alguno de los modos de texto, la función `open()` devuelve un objeto del tipo `TextIOWrapper`.

- Se leen y escriben strings.
- Python hace decodificación/codificación UTF-8

#### Combinaciones en modo texto
Tener en cuenta que el modificador `t` usualmente no se pone ya que es el modo por defecto.

- `r` $\rightarrow$ leer texto
- `w` $\rightarrow$ escribir texto (borra lo anterior)
- `a` $\rightarrow$ agregar texto al final
- `r+` $\rightarrow$ leer y escribir texto (no borra)
- `w+` $\rightarrow$ leer y escribir texto (borra al abrir)
- `a+` $\rightarrow$ leer y escribir pero las escrituras van al final

### Modos binarios
Al abrir un archivo con alguno de los modos binarios, Python devuelve un objeto tipo `BufferedReader` / `BufferedWriter` (capa binaria con buffer).

- Se leen/escriben **bytes** (`bytes`).
- No hay encoding.

#### Combinaciones en modo binario
Se agrega el modificador `b`.

- `rb` $\rightarrow$ leer bytes
- `wb` $\rightarrow$ escribir bytes (borra lo anterior)
- `ab` $\rightarrow$ agregar bytes al final
- `rb+` $\rightarrow$ leer y escribir bytes (no borra)
- `wb+` $\rightarrow$ leer y escribir bytes (borra al abrir)
- `ab+` $\rightarrow$ leer y escribir bytes, pero las escrituras van al final

# Tabla resumen

|  **Modo**  | **Si existe** | **Si no existe** | **¿Borra contenido?** | **Tipo** |
| :--------: | :-----------: | :--------------: | :-------------------: | :------: |
|    `r`     |       ✅       |     ❌ error      |           ❌           |  texto   |
|    `w`     |       ✅       |      ✅ Crea      |           ✅           |  texto   |
|    `a`     |       ✅       |      ✅ Crea      |           ❌           |  texto   |
|    `x`     |    ❌error     |      ✅ Crea      |          --           |  texto   |
| `rb/wb/ab` |     igual     |      igual       |         igual         |  bytes   |
